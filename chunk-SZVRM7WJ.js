import{a as ie,b as s,c as ae,d as se,e as le,g as de,h as j,i as ue,j as ce,k as me,l as pe}from"./chunk-TDTRECDD.js";import{a as te,f as L,m as re,n as oe}from"./chunk-AG74TOS6.js";import{$a as X,Ca as S,L as I,La as C,Ma as G,Na as D,O as x,T as f,Ua as d,Va as m,Wa as z,Xa as Y,Z as $,Za as b,_ as q,a as y,ab as J,b as R,bb as U,bc as ne,db as Z,ha as V,ja as g,kb as ee,p as E,sa as Q,ta as c,u as v,v as O,vb as p,w,wa as W,wb as T,xa as K,z as k}from"./chunk-MLHRJ3PS.js";function he(t){return{h1:t?"oklch(0.634 0.254 18)":"oklch(0.355 0.146 29)",h2:t?"oklch(0.858 0.146 197)":"oklch(0.377 0.1 247)",line:t?"#E0FFE0":"#305030",activeline:t?"#80FF80":"#008000",shadow:t?"#000000":"#202020"}}function ve(t){return t?"#D0D0D0":"#303030"}function fe(t){return{lines:t?"#C0C0C0":"#606060",border:t?"#F0F0F0":"#101010"}}var H=1,ge=18,M=10,l=2e3,Ge=7,Ce=5,be=10;function ze(t,e,n,r,o){let a=new OffscreenCanvas(n,n),i=a.getContext("2d");i.imageSmoothingQuality="high",i.imageSmoothingEnabled=!0;let h=s.point({x:0,y:n}),F=s.point({x:n,y:0}),B=he(o);i.save(),i.globalCompositeOperation="destination-over",r!=="h2"&&Se(i,F,e.h2,B,"h2"),r!=="h1"&&Se(i,h,e.h1,B,"h1"),i.restore(),i.save(),r===null&&(i.globalCompositeOperation="destination-over"),De(i,h,F,e,r!==null,o),i.restore(),r!==null&&Me(i,r==="h1"?h:F,e[r],B,r),i.save(),i.globalCompositeOperation="destination-over",Te(i,n,o),i.restore();let ke=a.transferToImageBitmap();t.transferFromImageBitmap(ke)}function De(t,e,n,r,o,a){let i=ve(a);t.save(),t.beginPath(),t.moveTo(e.x,e.y),t.strokeStyle=i,t.bezierCurveTo(r.h1.x,r.h1.y,r.h2.x,r.h2.y,n.x,n.y),t.lineWidth=H*(o!==null?3:2),t.stroke(),t.restore()}function Te(t,e,n){let r=fe(n),o=e/l,a=l/be;t.save(),t.beginPath();for(let i=1;i<be;i++){let h=s.value(i*a*o);t.moveTo(0,h),t.lineTo(e,h),t.moveTo(h,0),t.lineTo(h,e)}t.setLineDash([1,3]),t.strokeStyle=r.lines,t.lineWidth=s.value(H*.5),t.stroke(),t.restore(),t.save(),t.beginPath(),t.rect(0,0,s.value(o*l),s.value(o*l)),t.strokeStyle=r.border,t.lineWidth=s.value(H*1),t.stroke(),t.restore()}function Se(t,e,n,r,o){t.save(),t.beginPath(),t.arc(n.x,n.y,M,0,Math.PI*2),t.fillStyle=r[o],t.fill(),t.beginPath(),t.lineWidth=s.value(H),t.moveTo(e.x,e.y),t.lineTo(n.x,n.y),t.strokeStyle=r.line,t.stroke(),t.restore()}function Me(t,e,n,r,o){t.save(),t.shadowColor=r.shadow,t.shadowBlur=Ge,t.shadowOffsetX=Ce,t.shadowOffsetY=Ce,t.save(),t.beginPath(),t.lineWidth=s.value(H*1.5),t.moveTo(e.x,e.y),t.lineTo(n.x,n.y),t.strokeStyle=r.activeline,t.stroke(),t.restore(),t.translate(n.x,n.y),t.beginPath(),t.arc(0,0,M,0,Math.PI*2),t.arc(0,0,ge,0,Math.PI*2,!0),t.arc(0,0,ge-s.value(H*2),0,Math.PI*2),t.fillStyle=r[o],t.fill("evenodd"),t.restore()}function He(t,e){let n=l/e;return s.point({x:s.value(Math.max(0,Math.min(t.x,e))*n),y:s.value(Math.max(0,Math.min(e-t.y,e))*n)})}function N(t,e){let n=e/l;return s.point({x:Math.max(0,Math.min(t.x,l))*n,y:e-Math.max(0,Math.min(t.y,l))*n})}var ye={colors:{start:[249,147,52],end:[7,10,95]},handlers:{h1:{x:6.8,y:120},h2:{x:40,y:193.6}},angle:0};var u=class t{store=f(te);initialState=this.store.get("gradient-state")??ye;angleDegrees=g(this.initialState.angle);startRGBColor=g(this.initialState.colors.start);endRGBColor=g(this.initialState.colors.end);handlers=g(this.initialState.handlers);startOklch=p(()=>L(this.rgbText(this.startRGBColor())));endOklch=p(()=>L(this.rgbText(this.endRGBColor())));points=p(()=>se.points(this.handlers(),l,l));startColor=p(()=>this.oklchText(this.startOklch()));endColor=p(()=>this.oklchText(this.endOklch()));gradient=p(()=>le(this.startOklch(),this.endOklch(),this.points(),this.angleDegrees()));controlGradient=p(()=>de(this.gradient().stops,90,"oklch"));currentState=p(()=>({colors:{start:this.startRGBColor(),end:this.endRGBColor()},handlers:this.handlers(),angle:this.angleDegrees()}));constructor(){T(()=>this.store.save("gradient-state",this.currentState()))}onAngleDegreesChange(e){this.angleDegrees.set(e)}onStartColorChange(e){this.startRGBColor.set(e)}onEndColorChange(e){this.endRGBColor.set(e)}onHandlersChange(e){this.handlers.set(y({},e))}rgbText(e){return`rgb(${Math.round(e[0])} ${Math.round(e[1])} ${Math.round(e[2])})`}oklchText(e){return`oklch(${e[0].toFixed(3)} ${e[1].toFixed(3)} ${e[2].toFixed(1)})`}static \u0275fac=function(n){return new(n||t)};static \u0275prov=x({token:t,factory:t.\u0275fac,providedIn:"root"})};var P=class t{state=f(u);handleSwapShortcut(e){e.preventDefault(),this.swap()}swap(){let e=this.state.startRGBColor(),n=this.state.endRGBColor();this.state.onStartColorChange(n),this.state.onEndColorChange(e)}onColorEndChange(e){this.state.onEndColorChange(e)}onColorStartChange(e){this.state.onStartColorChange(e)}static \u0275fac=function(n){return new(n||t)};static \u0275cmp=S({type:t,selectors:[["zz-gradient-colors"]],hostAttrs:[1,"w-full"],hostBindings:function(n,r){n&1&&b("keydown.control.shift.y",function(a){return r.handleSwapShortcut(a)},!1,Q)},decls:6,vars:4,consts:[[1,"flex","flex-row","items-center","justify-center","gap-2","w-full"],[1,"shadow-md",3,"color-changing","border","color"],["title","Swap colors (Ctrl+Shift+Y)",1,"shadow-md","w-5","h-5","-mt-1",3,"click"],[1,"font-icons","text-larger-5","leading-5"]],template:function(n,r){n&1&&(d(0,"div",0)(1,"zz-color-selector",1),b("color-changing",function(a){return r.onColorStartChange(a)}),m(),d(2,"button",2),b("click",function(){return r.swap()}),d(3,"span",3),Z(4,"swap_horiz"),m()(),d(5,"zz-color-selector",1),b("color-changing",function(a){return r.onColorEndChange(a)}),m()()),n&2&&(c(),C("border","border-current/40")("color",r.state.startRGBColor()),c(4),C("border","border-current/40")("color",r.state.endRGBColor()))},dependencies:[re],encapsulation:2,changeDetection:0})};var Pe=["canvas"],_=class t{constructor(e){this.renderer=e;T(()=>{let n=this.handlersToCanvas(this.state.handlers());this.dibujar(n,this.currentHandler(),this.size(),this.darkMode())})}mouseMoveSubscription=null;moveSubscription=null;startSubscription=null;removeDocumentClickListenerFn=null;removeDocumentTouchEndListenerFn=null;state=f(u);overHandler=g(null);currentHandler=g(null);size=V(200);darkMode=V(!1);canvas;canvasContext=null;canvasRealSize=0;ngAfterViewInit(){this.mouseMoveSubscription=v(this.canvas.nativeElement,"mousemove").pipe(w(()=>this.currentHandler()===null),k(5),E(e=>e)).subscribe(e=>{this.onMouseMove(e)}),this.moveSubscription=O(v(document,"mousemove"),v(document,"touchmove",{passive:!1})).pipe(w(()=>this.currentHandler()!==null),I(e=>e.preventDefault()),k(1),E(e=>e)).subscribe(e=>{this.onMoveHandler(e)}),this.startSubscription=O(v(this.canvas?.nativeElement,"mousedown").pipe(E(e=>e)),v(this.canvas?.nativeElement,"touchstart",{passive:!1}).pipe(E(e=>{let n=this.pointFromEvent(e);return this.isOverHandler(n)!==null?e:null}),w(e=>e!==null),I(e=>e.preventDefault()))).pipe(w(()=>this.currentHandler()===null),k(1)).subscribe(e=>{this.onGrabHandler(e)}),this.canvasRealSize=this.realSize(),this.dibujar(this.handlersToCanvas(this.state.handlers()))}onDoubleClick(e){let n=this.overHandler();if(n===null)return;let r=s.value((n==="h1"?1:2)/3*l);this.state.onHandlersChange(R(y({},this.state.handlers()),{[n]:{x:r,y:r}}))}onGrabHandler(e){let n=this.pointFromEvent(e),r=this.isOverHandler(n);r!==null&&this.setHandlerSelected(r)}onMoveHandler(e){let n=this.pointFromEvent(e);this.updateHandlerCoords(n)}onMouseMove(e){let n=this.pointFromEvent(e),r=this.overHandler(),o=this.isOverHandler(n);r!==o&&this.overHandler.set(o)}stopTracking(){this.currentHandler()!==null&&(this.removeDocumentClickListenerFn?.(),this.removeDocumentTouchEndListenerFn?.(),this.currentHandler.set(null))}setHandlerSelected(e){this.setListeners(),this.currentHandler.set(e)}updateHandlerCoords(e){let n=this.currentHandler();n!==null&&this.state.onHandlersChange(R(y({},this.state.handlers()),{[n]:e}))}isOverHandler(e){let n=this.state.handlers(),r=M/this.size()*l;for(let o=1;o<=8;o++){if(j(e,n.h1,r*o))return"h1";if(j(e,n.h2,r*o))return"h2"}return null}setListeners(){this.removeDocumentClickListenerFn=this.renderer.listen("document","mouseup",()=>this.stopTracking()),this.removeDocumentTouchEndListenerFn=this.renderer.listen("document","touchend",()=>this.stopTracking(),{passive:!0})}dibujar(e,n=this.currentHandler(),r=this.size(),o=this.darkMode()){if(!this.canvas)return;this.canvasContext===null&&(this.canvasContext=this.canvas.nativeElement.getContext("bitmaprenderer"));let a=this.canvasContext;requestAnimationFrame(()=>{ze(a,e,r,n,o)})}handlersToCanvas(e){return{h1:N(e.h1,this.size()),h2:N(e.h2,this.size())}}pointFromEvent(e){let n=ae.pointFromEvent(this.canvas.nativeElement,e);return He(n,this.canvasRealSize)}realSize(){let e=this.canvas?.nativeElement,n=window.getComputedStyle(e),o=2*(parseFloat(n.paddingBottom.replace("px",""))||0),a=e.getBoundingClientRect();return a.bottom-a.top-o}ngOnDestroy(){this.removeDocumentClickListenerFn?.(),this.removeDocumentTouchEndListenerFn?.(),this.mouseMoveSubscription?.unsubscribe(),this.moveSubscription?.unsubscribe(),this.startSubscription?.unsubscribe()}static \u0275fac=function(n){return new(n||t)(K(W))};static \u0275cmp=S({type:t,selectors:[["zz-bezier-panel"]],viewQuery:function(n,r){if(n&1&&X(Pe,5),n&2){let o;J(o=U())&&(r.canvas=o.first)}},inputs:{size:[1,"size"],darkMode:[1,"darkMode"]},decls:3,vars:10,consts:[["canvas",""],["id","canvas",1,"rounded-lg",3,"dblclick","width","height"]],template:function(n,r){if(n&1){let o=Y();d(0,"div")(1,"canvas",1,0),b("dblclick",function(i){return $(o),q(r.onDoubleClick(i))}),m()()}n&2&&(c(),G("padding",r.size()/20,"px")("background",r.state.controlGradient()),D("cursor-grab",r.overHandler()!==null)("cursor-grabbing",r.currentHandler()!==null),C("width",r.size())("height",r.size()))},encapsulation:2,changeDetection:0})};var we=class t{state=f(u);bezierSize=280;compassSize=130;ngAfterViewInit(){v(document,"touchstart",{passive:!0}).subscribe(()=>{this.requestFullscreen()})}requestFullscreen(){document.fullscreenElement||document.documentElement.requestFullscreen().catch(()=>{console.info("Error attempting to enable full-screen mode")})}static \u0275fac=function(n){return new(n||t)};static \u0275cmp=S({type:t,selectors:[["zz-test-col"]],features:[ee([{provide:ce,useExisting:u},{provide:ue,useExisting:u}])],decls:12,vars:10,consts:[[1,"bg-application","w-screen","h-screen","overflow-hidden"],[1,"sticky","bg-application","z-20","top-0","left-0","right-0","shadow-md","dark:shadow-black/60"],[1,"w-screen","min-h-[calc(100vh_-_50px)]","grid","justify-center","place-content-start","auto-rows-auto","gap-4","px-4","pt-[10svh]","pb-8"],[3,"size","darkMode"],[1,"flex","items-center","gap-4","justify-center"],[1,"-ml-1",3,"size","darkMode"],[1,"flex","flex-col","items-center","gap-4","pr-1"]],template:function(n,r){n&1&&(d(0,"div",0)(1,"div",1),z(2,"zz-gradients-header"),m(),d(3,"main",2)(4,"div"),z(5,"zz-bezier-panel",3),d(6,"div",4),z(7,"zz-orientation-compass",5),d(8,"div",6),z(9,"zz-gradient-colors")(10,"zz-gradient-actions"),m()()()()(),z(11,"zz-notification")),n&2&&(c(3),G("background",r.state.gradient().gradient),D("text-gris-900",!r.state.gradient().darkMode)("text-gris-100",r.state.gradient().darkMode),c(2),C("size",r.bezierSize)("darkMode",r.state.gradient().darkMode),c(2),C("size",r.compassSize)("darkMode",r.state.gradient().darkMode))},dependencies:[oe,ie,ne,P,_,me,pe],encapsulation:2,changeDetection:0})};export{we as BezierGradientComponent};
