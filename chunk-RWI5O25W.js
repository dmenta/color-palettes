import{a as ce,b as pe,d as me,f as A,g as de,k as ue,l as Se,m as ze,n as Ge}from"./chunk-VYDFLDXA.js";import{$b as V,Ia as f,Ja as F,Jb as fe,Ka as Z,La as ee,Lb as he,M as J,Mb as ge,Nb as ve,Ob as Ce,Pa as te,Pb as ye,Qa as ne,R as u,Ra as l,Rb as be,Sa as c,Ta as v,Ua as oe,Ub as xe,Vb as we,Wa as C,X as x,Xa as ie,Y as w,Ya as re,Za as ae,_a as se,a as M,ab as S,b as I,fa as N,ha as k,pa as H,qa as d,sb as z,tb as le,za as h}from"./chunk-26NIUJBM.js";var B=class n{static \u0275fac=function(t){return new(t||n)};static \u0275cmp=h({type:n,selectors:[["zz-gradients-header"]],decls:8,vars:1,consts:[[1,"flex","items-center","justify-between","m-auto","h-[50px]","pl-6","pr-4","py-1","max-w-[1600px]","leading-8"],[1,"text-2xl","opacity-90"],[3,"format"],[1,"flex","items-center","gap-4"],["href","palettes",1,"text-smaller","opacity-85","hover:opacity-100"]],template:function(t,o){t&1&&(l(0,"header")(1,"div",0)(2,"h1",1),v(3,"zz-marca",2),c(),l(4,"div",3)(5,"a",4),S(6,"Palettes"),c(),v(7,"zz-dark-mode-toggle"),c()()()),t&2&&(d(3),f("format","horizontal"))},dependencies:[pe,ue],encapsulation:2,changeDetection:0})};var _e=[{value:"to right",icon:"&#x2192;",class:"rotate-90"},{value:"to right bottom",icon:"&#x2198;",class:"rotate-135"},{value:"to bottom",icon:"&#x2193;",class:"rotate-180"},{value:"to left bottom",icon:"&#x2199;",class:"-rotate-135"},{value:"to left",icon:"&#x2190;",class:"-rotate-90"},{value:"to left top",icon:"&#x2196;",class:"-rotate-45"},{value:"to top",icon:"&#x2191;",class:"rotate-0"},{value:"to right top",icon:"&#x2197;",class:"rotate-45"}];var Me={colors:{source:[208,22,130],destination:[37,24,119]},handlers:{point1:{x:20,y:80},point2:{x:40,y:70}},orientation:"to right bottom"};function ke(n){let t=n.point1.x,o=n.point2.x,i=100,r=0,a=n.point1.y,m=n.point2.y,_=100,y=[];for(let p=0;p<=1;p+=.05){let D=Math.pow(1-p,3)*0+3*Math.pow(1-p,2)*p*t+3*(1-p)*Math.pow(p,2)*o+Math.pow(p,3)*i,P=Math.pow(1-p,3)*r+3*Math.pow(1-p,2)*p*a+3*(1-p)*Math.pow(p,2)*m+Math.pow(p,3)*_;y.push({x:D,y:P})}return y.push({x:100,y:100}),y}function Te(n,e,t,o){let i=t.map(s=>s.x).filter(s=>s<=50).sort((s,b)=>b-s),r=t.map(s=>s.x).filter(s=>s>50).sort((s,b)=>s-b),a=0;50-i[0]<r[0]-50?a=i.length-1:a=i.length;let m=e[0]-n[0],_=e[1]-n[1],y=e[2]-n[2],p=n[2]+360-e[2],D=n[2],P=D,L=1;y>p&&(n[2]=n[2]+360,P=D+360,L=-1);let Be=Math.min(y,p),Oe=n[0],Ee=n[1],U="",Y=[],j=[];for(let s=0;s<t.length;s++){let b=t[s].y,X=b*m/100+Oe,W=b*_/100+Ee,Q=L*(b*Be)/100+P;s===a&&(U=`oklch(${X.toFixed(3)} ${W.toFixed(3)} ${Q.toFixed(1)})`);let q=t[s].x,K=`oklch(${X.toFixed(3)} ${W.toFixed(3)} ${Q.toFixed(1)})`,$e=me(K).color;j.push({offset:q,color:$e}),Y.push(`${K} ${q.toFixed(1)}%`)}return{gradient:`linear-gradient(${o} in oklch, ${Y})`,contrast:de(U),gradientRGB:`linear-gradient(${o} in srgb, ${j.map(s=>`${s.color} ${s.offset.toFixed(1)}%`).join(", ")})`,pasosRGB:j}}var g=class n{store=u(ce);initialState=this.store.get("gradient-state")??Me;orientation=k(this.initialState.orientation);sourceColor=k(this.initialState.colors.source);destinationColor=k(this.initialState.colors.destination);handlers=k(this.initialState.handlers);sourceOklch=z(()=>A(this.rgbText(this.sourceColor())));destinationOklch=z(()=>A(this.rgbText(this.destinationColor())));points=z(()=>ke(this.handlers()));gradient=z(()=>Te(this.sourceOklch(),this.destinationOklch(),this.points(),this.orientation()));currentState=z(()=>({colors:{source:this.sourceColor(),destination:this.destinationColor()},handlers:this.handlers(),orientation:this.orientation()}));constructor(){le(()=>this.store.save("gradient-state",this.currentState()))}onOrientationChange(e){this.orientation.set(e)}onSourceColorChange(e){this.sourceColor.set(e)}onDestinationColorChange(e){this.destinationColor.set(e)}onHandlersChange(e){this.handlers.set(M({},e))}rgbText(e){return`rgb(${Math.round(e[0])} ${Math.round(e[1])} ${Math.round(e[2])})`}static \u0275fac=function(t){return new(t||n)};static \u0275prov=J({token:n,factory:n.\u0275fac,providedIn:"root"})};var Re=(n,e)=>e.value;function je(n,e){if(n&1&&(l(0,"label",3),v(1,"input",4),l(2,"span",5),S(3,"arrow_upward_alt"),c()()),n&2){let t=e.$implicit,o=e.$index,i=ie();Z("opacity-100",t.value===i.orientationGroup.value.orientation),f("for","radio"+o),d(),f("value",t.value)("id","radio"+o),d(),ee(t.class)}}var O=class n{orientationsValues=_e;state=u(g);orientationGroup=new ve({orientation:new Ce(this.state.orientation(),{nonNullable:!0})});ngOnInit(){this.orientationGroup.valueChanges.subscribe(e=>{this.state.onOrientationChange(e.orientation??"to right bottom")})}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=h({type:n,selectors:[["zz-orientation-selector"]],decls:4,vars:1,consts:[[3,"formGroup"],[1,"select-none","flex","flex-row","gap-2"],[1,"transition-all","cursor-pointer","hover:opacity-80","has-checked:cursor-default","opacity-50","h-10","w-10","border-3","border-current/30","rounded-full","items-center","justify-center","has-checked:font-bold","has-checked:opacity-100","text-4xl","flex",3,"opacity-100","for"],[1,"transition-all","cursor-pointer","hover:opacity-80","has-checked:cursor-default","opacity-50","h-10","w-10","border-3","border-current/30","rounded-full","items-center","justify-center","has-checked:font-bold","has-checked:opacity-100","text-4xl","flex",3,"for"],["type","radio","formControlName","orientation",1,"hidden",3,"value","id"],[1,"font-icons"]],template:function(t,o){t&1&&(l(0,"form",0)(1,"div",1),te(2,je,4,7,"label",2,Re),c()()),t&2&&(f("formGroup",o.orientationGroup),d(2),ne(o.orientationsValues))},dependencies:[V,ye,fe,be,he,ge,xe,we],encapsulation:2})};var E=class n{state=u(g);onColorDestinationChange(e){this.state.onDestinationColorChange(e)}onColorSourceChange(e){this.state.onSourceColorChange(e)}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=h({type:n,selectors:[["zz-gradient-colors"]],hostAttrs:[1,"w-full"],decls:3,vars:4,consts:[[1,"flex","flex-row","items-center","justify-between","gap-4","w-full"],[3,"color-change","border","color"]],template:function(t,o){t&1&&(l(0,"div",0)(1,"zz-color-selector",1),C("color-change",function(r){return o.onColorSourceChange(r)}),c(),l(2,"zz-color-selector",1),C("color-change",function(r){return o.onColorDestinationChange(r)}),c()()),t&2&&(d(),f("border","border-current/40")("color",o.state.sourceColor()),d(),f("border","border-current/40")("color",o.state.destinationColor()))},dependencies:[ze],encapsulation:2})};function Fe(n,e,t,o,i){let r=new OffscreenCanvas(t,t),a=r.getContext("2d");Ie(a,t,i);let m=Ne(i),_=Ae(i);He(a,{x:0,y:t},e.point1,m.line),De(a,e.point1,m.h1),He(a,{x:t,y:0},e.point2,m.line),De(a,e.point2,m.h2),o==="H1"?Pe(a,e.point1,m.h1):o==="H2"&&Pe(a,e.point2,m.h2),a.beginPath(),a.moveTo(0,t),a.strokeStyle=_,a.bezierCurveTo(e.point1.x,e.point1.y,e.point2.x,e.point2.y,t,0),a.lineWidth=2,a.stroke();let y=r.transferToImageBitmap();n.transferFromImageBitmap(y)}function Ie(n,e,t){let o=Le(t);n.beginPath(),n.rect(0,0,e,e),n.strokeStyle=o.border,n.lineWidth=1,n.stroke();let i=e/100;n.strokeStyle=o.lines;for(let r=10;r<=90;r+=10)n.beginPath(),n.moveTo(0,r*i),n.lineTo(e,r*i),n.lineWidth=.5,n.stroke(),n.beginPath(),n.moveTo(r*i,0),n.lineTo(r*i,e),n.lineWidth=.5,n.stroke()}function De(n,e,t){n.beginPath(),n.arc(e.x,e.y,5,0,Math.PI*2),n.fillStyle=t,n.fill()}function Pe(n,e,t){n.beginPath(),n.arc(e.x,e.y,7,0,Math.PI*2),n.strokeStyle=t,n.stroke()}function He(n,e,t,o){n.beginPath(),n.moveTo(e.x,e.y),n.lineTo(t.x,t.y),n.strokeStyle=o,n.stroke()}function Ne(n){return{h1:n==="black"?"darkred":"red",h2:n==="black"?"navy":"blue",line:n==="black"?"#405040":"#E0FFE0"}}function Ae(n){return n==="black"?"#303030":"#D0D0D0"}function Le(n){return{lines:n==="black"?"#606060":"#C0C0C0",border:n==="black"?"#101010":"#F0F0F0"}}var Ue=["canvas"],$=class n{currentHandler=null;lastTimeoutId=null;canvasOffset=30;state=u(g);size=N(200);color=N("black");canvas;onDocumentMouseUp(){this.currentHandler&&this.stopTracking()}ngAfterViewInit(){this.dibujar(this.state.handlers(),this.size())}onMouseDown(e){let t=this.canvas?.nativeElement;if(!t)return;let o=t.getBoundingClientRect();this.setHandlerSelected(e.clientX-o.left,e.clientY-o.top)}onMouseMove(e){if(!this.currentHandler)return;let t=this.canvas?.nativeElement;if(!t)return;let o=t.getBoundingClientRect();this.updateHandlerCoords(e.clientX-o.left,e.clientY-o.top)}updateHandlerCoords(e,t){let o=this.convertXFromCanvas(e),i=this.convertYFromCanvas(t);this.currentHandler==="H1"?this.state.onHandlersChange(I(M({},this.state.handlers()),{point1:{x:o,y:i}})):this.currentHandler==="H2"&&this.state.onHandlersChange(I(M({},this.state.handlers()),{point2:{x:o,y:i}})),this.dibujar(this.state.handlers(),this.size())}onMouseUp(){this.stopTracking()}onMouseLeave(){this.setStopTimeout()}onMouseEnter(){this.currentHandler!==null&&this.clearStopTimeout()}setStopTimeout(){this.currentHandler!==null&&(this.clearStopTimeout(),this.lastTimeoutId=window.setTimeout(()=>this.stopTracking(),1e3))}clearStopTimeout(){this.lastTimeoutId&&(window.clearTimeout(this.lastTimeoutId),this.lastTimeoutId=null)}stopTracking(){this.currentHandler!==null&&(this.currentHandler=null,this.clearStopTimeout())}setHandlerSelected(e,t){let o=this.convertXFromCanvas(e),i=this.convertYFromCanvas(t),r={x:o,y:i},a=this.state.handlers();if(this.checkCoordsMatch(r,a.point1)){this.currentHandler="H1";return}if(this.checkCoordsMatch(r,a.point2)){this.currentHandler="H2";return}}checkCoordsMatch(e,t){return t.x+6>e.x&&t.x-6<e.x&&t.y+6>e.y&&t.y-6<e.y}convertXFromCanvas(e){let t=this.size();return Math.max(0,Math.min(e-this.canvasOffset,t))/t*100}convertYFromCanvas(e){let t=this.size();return Math.max(0,Math.min(t-e+this.canvasOffset,t))/t*100}convertXToCanvas(e){let t=this.size();return Math.max(0,Math.min(e,100))*t/100}convertYToCanvas(e){let t=this.size();return t-Math.max(0,Math.min(e,t))*t/100}dibujar(e,t=this.size()){let o={point1:{x:this.convertXToCanvas(e.point1.x),y:this.convertYToCanvas(e.point1.y)},point2:{x:this.convertXToCanvas(e.point2.x),y:this.convertYToCanvas(e.point2.y)}},i=this.canvas?.nativeElement.getContext("bitmaprenderer");i&&requestAnimationFrame(()=>{Fe(i,o,t,this.currentHandler,this.color())})}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=h({type:n,selectors:[["zz-bezier-panel"]],viewQuery:function(t,o){if(t&1&&re(Ue,5),t&2){let i;ae(i=se())&&(o.canvas=i.first)}},hostBindings:function(t,o){t&1&&C("mouseup",function(){return o.onDocumentMouseUp()},!1,H)},inputs:{size:[1,"size"],color:[1,"color"]},decls:3,vars:4,consts:[["canvas",""],["id","canvas",1,"bg-gris-500/20","rounded-lg",3,"mousedown","mousemove","mouseup","mouseleave","mouseenter","width","height"]],template:function(t,o){if(t&1){let i=oe();l(0,"div")(1,"canvas",1,0),C("mousedown",function(a){return x(i),w(o.onMouseDown(a))})("mousemove",function(a){return x(i),w(o.onMouseMove(a))})("mouseup",function(){return x(i),w(o.onMouseUp())})("mouseleave",function(){return x(i),w(o.onMouseLeave())})("mouseenter",function(){return x(i),w(o.onMouseEnter())}),c()()}t&2&&(d(),F("padding",o.canvasOffset,"px"),f("width",o.size())("height",o.size()))},encapsulation:2})};var R=class n{copyService=u(Se);state=u(g);handleCopyShortcut(e){e.preventDefault(),this.copy()}copy(){this.onSaveFile("gradient","svg",this.toSVG())}onSaveFile(e,t,o){let i=e+"."+t,r=o,a=new Blob([r],{type:"image/svg+xml"}),m=document.createElement("a");m.href=URL.createObjectURL(a),m.download=i,m.click(),m.remove()}toSVG(){return`<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg width="100%" height="100%" viewBox="0 0 400 200" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" xmlns:serif="http://www.serif.com/" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;">
    <rect x="0" y="0" width="400" height="200" style="fill:url(#_Linear1);"/>
    <defs>
        <linearGradient id="_Linear1" x1="0" y1="0" x2="1" y2="0" gradientUnits="userSpaceOnUse" gradientTransform="matrix(400,200,-200,400,0,0)">
${this.state.gradient().pasosRGB.map(t=>`        <stop offset="${(t.offset/100).toFixed(3)}" style="stop-color:${t.color};stop-opacity:1"/>`).join(`
`)}
        </linearGradient>
    </defs>
</svg>`}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=h({type:n,selectors:[["zz-gradient-actions"]],hostBindings:function(t,o){t&1&&C("keydown.control.shift.c",function(r){return o.handleCopyShortcut(r)},!1,H)},decls:2,vars:0,consts:[["title","Copy gradient (Ctrl+Shift+C)",1,"icon-button",3,"click"]],template:function(t,o){t&1&&(l(0,"button",0),C("click",function(){return o.copy()}),S(1,"content_copy"),c())},encapsulation:2})};var Ve=class n{state=u(g);size=350;static \u0275fac=function(t){return new(t||n)};static \u0275cmp=h({type:n,selectors:[["zz-test-col"]],decls:11,vars:6,consts:[[1,"bg-application","w-screen","h-screen","overflow-x-hidden"],[1,"sticky","bg-application","z-20","top-0","left-0","right-0","shadow-md","dark:shadow-black/60"],[1,"w-screen","min-h-[calc(100svh_-_50px)]","flex","flex-col","items-center","justify-center","gap-4"],[1,"flex","flex-col","items-center","justify-center","gap-4","w-[130px]"],[3,"size","color"],[1,"flex","flex-row","items-center","justify-between","gap-4","w-full"]],template:function(t,o){t&1&&(l(0,"div",0)(1,"div",1),v(2,"zz-gradients-header"),c(),l(3,"main",2)(4,"div",3),v(5,"zz-bezier-panel",4),l(6,"div",5),v(7,"zz-gradient-colors")(8,"zz-gradient-actions"),c(),v(9,"zz-orientation-selector"),c()()(),v(10,"zz-notification")),t&2&&(d(3),F("color",o.state.gradient().contrast)("background",o.state.gradient().gradient),d(2),f("size",o.size)("color",o.state.gradient().contrast))},dependencies:[Ge,B,V,O,E,$,R],encapsulation:2})};export{Ve as BezierGradientComponent};
