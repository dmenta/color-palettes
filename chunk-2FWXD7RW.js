import{a as fe,b as ge,d as ve,f as le,g as Ce,k as be,l as Se,m as we,n as Me}from"./chunk-2V6WTP6L.js";import{$a as U,C as se,Ca as S,L as E,La as w,Ma as X,Na as B,O as me,T as C,Ua as h,Va as p,Wa as H,Xa as q,Z as j,Za as g,_ as W,a as R,ab as K,b as re,bb as Q,bc as ye,db as z,ha as F,ja as b,p as f,ra as ae,sa as I,ta as y,u as v,v as _,vb as k,w as P,wa as N,wb as V,xa as Y,z as G}from"./chunk-5QCH5TM6.js";var J=class e{static \u0275fac=function(t){return new(t||e)};static \u0275cmp=S({type:e,selectors:[["zz-gradients-header"]],decls:8,vars:1,consts:[[1,"flex","items-center","justify-center","md:justify-between","m-auto","h-[50px]","pl-6","pr-4","py-1","max-w-[1600px]","leading-8"],[1,"text-2xl","opacity-90"],[3,"format"],[1,"hidden","md:flex","items-center","gap-4"],["href","palettes",1,"text-smaller","opacity-85","hover:opacity-100"]],template:function(t,o){t&1&&(h(0,"header")(1,"div",0)(2,"h1",1),H(3,"zz-marca",2),p(),h(4,"div",3)(5,"a",4),z(6,"Palettes"),p(),H(7,"zz-dark-mode-toggle"),p()()()),t&2&&(y(3),w("format","horizontal"))},dependencies:[ge,be],encapsulation:2,changeDetection:0})};var ke={colors:{start:[249,147,52],end:[7,10,95]},handlers:{h1:{x:3.4,y:60},h2:{x:20,y:96.8}},angle:0};function Pe(e){let t=e.h1.x,o=e.h2.x,i=100,r=0,s=e.h1.y,a=e.h2.y,c=100,d=[];for(let l=0;l<=1;l+=.05){let u=Math.pow(1-l,3)*0+3*Math.pow(1-l,2)*l*t+3*(1-l)*Math.pow(l,2)*o+Math.pow(l,3)*i,m=Math.pow(1-l,3)*r+3*Math.pow(1-l,2)*l*s+3*(1-l)*Math.pow(l,2)*a+Math.pow(l,3)*c;d.push({x:u,y:m})}return d.push({x:100,y:100}),d}function Z(e,n){if(!n)return{x:0,y:0};let t=window.getComputedStyle(n),o=parseFloat(t.paddingLeft.replace("px",""))||0,i=o*2,r=n.getBoundingClientRect(),s=r.bottom-r.top-i;if(e instanceof TouchEvent){if(e.touches.length===0)return{x:0,y:0};let a=e.touches[0];return{x:a.clientX-r.left-o,y:s-(a.clientY-r.top-o)}}else return{x:e.clientX-r.left-o,y:s-(e.clientY-r.top-o)}}function L(e,n,t=9){return n.x+t>e.x&&n.x-t<e.x&&n.y+t>e.y&&n.y-t<e.y}function Ee(e,n,t,o=0){let i=Ue(e,n),r=qe(e,n),s=Ke(e,n),a=[],c=[];for(let l=0;l<t.length;l++){let u=t[l],m=u.y/100,D=(m*i.range+i.delta).toFixed(3),x=(m*r.range+r.delta).toFixed(3),T=(m*s.range+s.delta).toFixed(1),$=`oklch(${D} ${x} ${T})`;a.push({offset:u.x,color:$}),c.push({offset:u.x,color:ve($).color})}let d=Qe(t);return{stops:a,gradient:De(a,o,"oklch"),darkMode:Ce(a[d].color)==="white",gradientRGB:De(c,o,"srgb"),rgbStops:c}}function qe(e,n){return{range:n[1]-e[1],delta:e[1]}}function Ue(e,n){return{range:n[0]-e[0],delta:e[0]}}function Ke(e,n){let t=n[2]-e[2],o=t>180?e[2]+360:e[2];return{range:(t<-180?n[2]+360:n[2])-o,delta:o}}function De(e,n,t){return`linear-gradient(${n}deg in ${t}, ${e.map(o=>`${o.color} ${o.offset.toFixed(1)}%`).join(", ")})`}function Qe(e){let n=e.map(o=>o.x).filter(o=>o<=50).sort((o,i)=>i-o),t=e.map(o=>o.x).filter(o=>o>50).sort((o,i)=>o-i);return 50-n[0]<t[0]-50?n.length-1:n.length}var He=new Date(2025,0,1).valueOf();function Ge(e,n=0,t={width:1920,height:1080}){let o=document.createElement("canvas");o.width=t.width,o.height=t.height;let i=o.getContext("2d");if(!i){console.error("No se pudo obtener el contexto del canvas");return}let{x1:r,y1:s,x2:a,y2:c}=Te(o.width,o.height,n),d=i.createLinearGradient(r,s,a,c);for(let m=0;m<e.length;m++){let D=e[m];d.addColorStop(D.offset/100,D.color)}i.fillStyle=d,i.beginPath(),i.rect(0,0,o.width,o.height),i.fill();let l=document.createElement("a"),u=o.toDataURL("image/png",1);l.href=u,l.download=`colorina-gradient-${new Date().valueOf()-He}.png`,l.click(),l.remove()}function ze(e,n=0){let t=Je(e,n),o=new Blob([t],{type:"image/svg+xml"}),i=document.createElement("a");i.href=URL.createObjectURL(o),i.download=`colorina-gradient-${new Date().valueOf()-He}.svg`,i.click(),i.remove()}function Je(e,n=0){let i=Math.max(1920,1080),r=Math.min(1920,1080),s=Math.sqrt(1920*1920+1080*1080),{x1:a,y1:c,x2:d,y2:l,hypotenusa:u}=Te(1920,1080,n);u=Math.abs(u);let m=(i-u)/2,D=(r-s)/2,x=e.map(T=>`        <stop offset="${(T.offset/100).toFixed(3)}" style="stop-color:${T.color};stop-opacity:1"/>`).join(`
`);return`<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg width="100%" height="100%" viewBox="0 0 1920 1080" version="1.1" xmlns="http://www.w3.org/2000/svg"
     xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" xmlns:serif="http://www.serif.com/"
      style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;">

    <rect x="${m}" y="${D}" width="${u}" height="${s}"  style=" transform-origin: center center; transform: rotate(${n-90}deg); fill:url(#_Linear1);"/>
    <rect x="0" y="0" width="1920" height="1080" stroke="black" fill="none" />

  <defs>
        <linearGradient id="_Linear1" x1="${m}" y1="0" x2="${u}" y2="0" gradientUnits="userSpaceOnUse" >
${x}
        </linearGradient>
    </defs>
</svg>`}function Te(e,n,t){let o=e/2,i=n/2,r=Math.sin((t+90)*Math.PI*2/360),s=Math.cos((t+90)*Math.PI*2/360),a=Math.sqrt(o*o+i*i),c=a*s,d=Math.abs(i*r),l=a*r,u=Math.abs(o*s);l<-i?l=Math.max(l,-i-u):l>i&&(l=Math.min(l,i+u)),c<-o?c=Math.max(c,-o-d):c>o&&(c=Math.min(c,o+d));let m=Math.sqrt(c*c+l*l)*2;return{x1:o+c,y1:i+l,x2:o-c,y2:i-l,hypotenusa:m}}var M=class e{store=C(fe);initialState=this.store.get("gradient-state")??ke;angleDegrees=b(this.initialState.angle);startRGBColor=b(this.initialState.colors.start);endRGBColor=b(this.initialState.colors.end);handlers=b(this.initialState.handlers);startOklch=k(()=>le(this.rgbText(this.startRGBColor())));endOklch=k(()=>le(this.rgbText(this.endRGBColor())));points=k(()=>Pe(this.handlers()));startColor=k(()=>this.oklchText(this.startOklch()));endColor=k(()=>this.oklchText(this.endOklch()));gradient=k(()=>Ee(this.startOklch(),this.endOklch(),this.points(),this.angleDegrees()));currentState=k(()=>({colors:{start:this.startRGBColor(),end:this.endRGBColor()},handlers:this.handlers(),angle:this.angleDegrees()}));constructor(){V(()=>this.store.save("gradient-state",this.currentState()))}onAngleDegreesChange(n){this.angleDegrees.set(n)}onStartColorChange(n){this.startRGBColor.set(n)}onEndColorChange(n){this.endRGBColor.set(n)}onHandlersChange(n){this.handlers.set(R({},n))}rgbText(n){return`rgb(${Math.round(n[0])} ${Math.round(n[1])} ${Math.round(n[2])})`}oklchText(n){return`oklch(${n[0].toFixed(3)} ${n[1].toFixed(3)} ${n[2].toFixed(1)})`}static \u0275fac=function(t){return new(t||e)};static \u0275prov=me({token:e,factory:e.\u0275fac,providedIn:"root"})};var ee=class e{state=C(M);handleSwapShortcut(n){n.preventDefault(),this.swap()}swap(){let n=this.state.startRGBColor(),t=this.state.endRGBColor();this.state.onStartColorChange(t),this.state.onEndColorChange(n)}onColorEndChange(n){this.state.onEndColorChange(n)}onColorStartChange(n){this.state.onStartColorChange(n)}static \u0275fac=function(t){return new(t||e)};static \u0275cmp=S({type:e,selectors:[["zz-gradient-colors"]],hostAttrs:[1,"w-full"],hostBindings:function(t,o){t&1&&g("keydown.control.shift.y",function(r){return o.handleSwapShortcut(r)},!1,I)},decls:6,vars:4,consts:[[1,"flex","flex-row","items-center","justify-center","gap-2","w-full"],[1,"shadow-md",3,"color-changing","border","color"],["title","Swap colors (Ctrl+Shift+Y)",1,"shadow-md","w-5","h-5","-mt-1",3,"click"],[1,"font-icons","text-larger-5","leading-5"]],template:function(t,o){t&1&&(h(0,"div",0)(1,"zz-color-selector",1),g("color-changing",function(r){return o.onColorStartChange(r)}),p(),h(2,"button",2),g("click",function(){return o.swap()}),h(3,"span",3),z(4,"swap_horiz"),p()(),h(5,"zz-color-selector",1),g("color-changing",function(r){return o.onColorEndChange(r)}),p()()),t&2&&(y(),w("border","border-current/40")("color",o.state.startRGBColor()),y(4),w("border","border-current/40")("color",o.state.endRGBColor()))},dependencies:[we],encapsulation:2,changeDetection:0})};function _e(e){return{h1:e?"oklch(0.634 0.254 18)":"oklch(0.355 0.146 29)",h2:e?"oklch(0.858 0.146 197)":"oklch(0.377 0.1 247)",line:e?"#E0FFE0":"#305030",activeline:e?"#80FF80":"#008000",shadow:e?"#000000":"#202020"}}function xe(e){return e?"#D0D0D0":"#303030"}function Fe(e){return{lines:e?"#C0C0C0":"#606060",border:e?"#F0F0F0":"#101010"}}function Ve(e,n,t,o,i){let r=new OffscreenCanvas(t,t),s=r.getContext("2d");Ze(s,t,i);let a=_e(i),c=xe(i);Be(s,{x:t,y:0},n.h2,a,"h2",o==="h2"),Be(s,{x:0,y:t},n.h1,a,"h1",o==="h1"),s.beginPath(),s.moveTo(0,t),s.strokeStyle=c,s.bezierCurveTo(n.h1.x,n.h1.y,n.h2.x,n.h2.y,t,0),s.lineWidth=o!==null?3:2,s.stroke();let d=r.transferToImageBitmap();e.transferFromImageBitmap(d)}function Ze(e,n,t){let o=Fe(t);e.beginPath(),e.rect(0,0,n,n),e.strokeStyle=o.border,e.lineWidth=1,e.stroke();let i=n/100;e.strokeStyle=o.lines,e.setLineDash([2,2]);for(let r=10;r<=90;r+=10)e.beginPath(),e.moveTo(0,r*i),e.lineTo(n,r*i),e.lineWidth=.5,e.stroke(),e.beginPath(),e.moveTo(r*i,0),e.lineTo(r*i,n),e.lineWidth=.5,e.stroke();e.setLineDash([])}function Be(e,n,t,o,i="h1",r){tt(e,n,t,o,r),e.beginPath(),e.arc(t.x,t.y,7,0,Math.PI*2),e.fillStyle=o[i],e.fill(),r&&et(e,t,o,i)}function et(e,n,t,o="h1"){e.shadowColor=t.shadow,e.shadowBlur=7,e.shadowOffsetX=5,e.shadowOffsetY=5,e.beginPath(),e.arc(n.x,n.y,10,0,Math.PI*2),e.strokeStyle=t[o],e.lineWidth=2,e.stroke(),e.shadowColor="transparent"}function tt(e,n,t,o,i){e.beginPath(),e.lineWidth=i?1.5:1,e.moveTo(n.x,n.y),e.lineTo(t.x,t.y),e.strokeStyle=i?o.activeline:o.line,e.stroke()}function ce(e,n){let t=100/n;return{x:Math.max(0,Math.min(e.x,n))*t,y:Math.max(0,Math.min(n-e.y,n))*t}}function de(e,n){let t=n/100;return{x:Math.max(0,Math.min(e.x,100))*t,y:n-Math.max(0,Math.min(e.y,n))*t}}var nt=["canvas"],te=class e{constructor(n){this.renderer=n;V(()=>{let t=this.handlersToCanvas(this.state.handlers());this.dibujar(t,this.currentHandler(),this.size(),this.darkMode())})}mouseMoveSubscription=null;moveSubscription=null;startSubscription=null;removeDocumentClickListenerFn=null;removeDocumentTouchEndListenerFn=null;state=C(M);overHandler=b(null);currentHandler=b(null);size=F(200);darkMode=F(!1);canvas;canvasContext=null;requestFullscreen(){document.fullscreenElement||document.documentElement.requestFullscreen().catch(()=>{console.debug("Error attempting to enable full-screen mode")})}ngAfterViewInit(){this.mouseMoveSubscription=v(this.canvas.nativeElement,"mousemove").pipe(P(()=>this.currentHandler()===null),G(5),f(n=>n)).subscribe(n=>{this.onMouseMove(n)}),this.moveSubscription=_(v(document,"mousemove"),v(document,"touchmove",{passive:!1})).pipe(P(()=>this.currentHandler()!==null),E(n=>n.preventDefault()),G(1),f(n=>n)).subscribe(n=>{this.onMoveHandler(n)}),this.startSubscription=_(v(this.canvas?.nativeElement,"mousedown").pipe(f(n=>n)),v(this.canvas?.nativeElement,"touchstart",{passive:!1}).pipe(E(()=>this.requestFullscreen()),f(n=>{let t=this.pointFromEvent(n);return this.isOverHandler(t)!==null?n:null}),P(n=>n!==null),E(n=>n.preventDefault()))).pipe(P(()=>this.currentHandler()===null),G(1)).subscribe(n=>{this.onGrabHandler(n)}),this.canvas.nativeElement.oncontextlost=n=>{console.warn("Context lost",n)},this.dibujar(this.handlersToCanvas(this.state.handlers()))}onDoubleClick(n){let t=this.overHandler();t!==null&&this.state.onHandlersChange(re(R({},this.state.handlers()),{[t]:{x:50,y:50}}))}onGrabHandler(n){let t=this.pointFromEvent(n),o=this.isOverHandler(t);o!==null&&this.setHandlerSelected(o)}onMoveHandler(n){let t=this.pointFromEvent(n);this.updateHandlerCoords(t)}onMouseMove(n){let t=this.pointFromEvent(n),o=this.overHandler(),i=this.isOverHandler(t);o!==i&&this.overHandler.set(i)}stopTracking(){this.currentHandler()!==null&&(this.removeDocumentClickListenerFn?.(),this.removeDocumentTouchEndListenerFn?.(),this.currentHandler.set(null))}setHandlerSelected(n){this.setListeners(),this.currentHandler.set(n)}updateHandlerCoords(n){let t=this.currentHandler();t!==null&&this.state.onHandlersChange(re(R({},this.state.handlers()),{[t]:n}))}isOverHandler(n){let t=this.state.handlers();return L(n,t.h1,12)?"h1":L(n,t.h2,12)?"h2":null}setListeners(){this.removeDocumentClickListenerFn=this.renderer.listen("document","mouseup",()=>this.stopTracking()),this.removeDocumentTouchEndListenerFn=this.renderer.listen("document","touchend",()=>this.stopTracking(),{passive:!0})}dibujar(n,t=this.currentHandler(),o=this.size(),i=this.darkMode()){if(!this.canvas)return;this.canvasContext===null&&(this.canvasContext=this.canvas.nativeElement.getContext("bitmaprenderer"));let r=this.canvasContext;requestAnimationFrame(()=>{Ve(r,n,o,t,i)})}handlersToCanvas(n){return{h1:de(n.h1,this.size()),h2:de(n.h2,this.size())}}pointFromEvent(n){let t=this.canvas?.nativeElement;if(!t)return{x:0,y:0};let o=window.getComputedStyle(t),i=parseFloat(o.paddingLeft.replace("px",""))||0,r=parseFloat(o.paddingTop.replace("px",""))||0,a=(parseFloat(o.paddingBottom.replace("px",""))||0)+r,c=t.getBoundingClientRect(),d=c.bottom-c.top-a;if(n instanceof TouchEvent){if(n.touches.length===0)return{x:0,y:0};let l=n.touches[0];return ce({x:l.clientX-c.left-i,y:l.clientY-c.top-r},d)}else return ce({x:n.clientX-c.left-i,y:n.clientY-c.top-r},d)}ngOnDestroy(){this.removeDocumentClickListenerFn?.(),this.removeDocumentTouchEndListenerFn?.(),this.mouseMoveSubscription?.unsubscribe(),this.moveSubscription?.unsubscribe(),this.startSubscription?.unsubscribe()}static \u0275fac=function(t){return new(t||e)(Y(N))};static \u0275cmp=S({type:e,selectors:[["zz-bezier-panel"]],viewQuery:function(t,o){if(t&1&&U(nt,5),t&2){let i;K(i=Q())&&(o.canvas=i.first)}},inputs:{size:[1,"size"],darkMode:[1,"darkMode"]},decls:3,vars:8,consts:[["canvas",""],["id","canvas",1,"bg-gris-500/20","rounded-lg",3,"dblclick","width","height"]],template:function(t,o){if(t&1){let i=q();h(0,"div")(1,"canvas",1,0),g("dblclick",function(s){return j(i),W(o.onDoubleClick(s))}),p()()}t&2&&(y(),X("padding",o.size()/20,"px"),B("cursor-grab",o.overHandler()!==null)("cursor-grabbing",o.currentHandler()!==null),w("width",o.size())("height",o.size()))},encapsulation:2,changeDetection:0})};var ne=class e{copyService=C(Se);state=C(M);handleCopyShortcut(n){n.preventDefault(),this.copy()}handleSvgShortcut(n){n.preventDefault(),this.copy()}copy(){this.copyService.copy(this.state.gradient().gradient,"Gradient  copied!")}saveAsImage(){Ge(this.state.gradient().rgbStops,this.state.angleDegrees(),this.displayDimensions())}saveSVG(){ze(this.state.gradient().rgbStops,this.state.angleDegrees())}displayDimensions(){if(!("ontouchstart"in document.documentElement))return{width:1920,height:1080};let t=window.innerWidth??document.documentElement.clientWidth??1920,o=screen.height??window.innerHeight??1080,i=window.devicePixelRatio||1;return{width:Math.floor(t*i),height:Math.floor(o*i)}}static \u0275fac=function(t){return new(t||e)};static \u0275cmp=S({type:e,selectors:[["zz-gradient-actions"]],hostAttrs:[1,"block","w-full"],hostBindings:function(t,o){t&1&&g("keydown.control.shift.c",function(r){return o.handleCopyShortcut(r)},!1,I)("keydown.control.shift.g",function(r){return o.handleSvgShortcut(r)},!1,I)},decls:7,vars:0,consts:[[1,"flex","justify-center","gap-2","w-full"],["title","Download gradient as SVG (Ctrl+Shift+G)",1,"font-button","shadow-md","w-10","border-[1px]",3,"click"],["title","Save png gradient (Ctrl+Shift+C)",1,"font-button","shadow-md","w-10","border-[1px]",3,"click"],["title","Copy gradient (Ctrl+Shift+C)",1,"font-button","shadow-md","w-10","border-[1px]",3,"click"]],template:function(t,o){t&1&&(h(0,"div",0)(1,"button",1),g("click",function(){return o.saveSVG()}),z(2," SVG "),p(),h(3,"button",2),g("click",function(){return o.saveAsImage()}),z(4," PNG "),p(),h(5,"button",3),g("click",function(){return o.copy()}),z(6," COPY "),p()())},encapsulation:2,changeDetection:0})};function Oe(e){return{lines:e?"#909090":"#606060",border:e?"#a0a0a0":"#505050",preset:e?"#888888":"#777777",presetHover:e?"#C0C0C0":"#333333",activePreset:e?"#ffffff":"#000000"}}function Re(e){return{lines:e?"#cccccc":"#202020",tip:e?"oklch(0.355 0.146 29)":"oklch(0.634 0.254 18)",toe:e?"gray":"#d0d0d0"}}function Ae(e,n,t=100,o=.84,i=.9,r=null,s=!1,a=!1){let c=new OffscreenCanvas(t,t),d=c.getContext("2d");if(!d)return;ot(d,t,o,i,r,n,a),rt(d,n,t,o,s,a);let l=c.transferToImageBitmap();e.transferFromImageBitmap(l)}function ot(e,n,t=.84,o=.9,i=null,r=0,s){let a=Math.round(n/2);e.beginPath(),e.arc(a,a,Math.round(a*t),0,Math.PI*2),e.lineWidth=1,e.fillStyle="#7A736E33",e.fill(),e.setLineDash([]),e.strokeStyle="transparent";let c=Math.round(t*a),d=Oe(s);e.beginPath(),e.arc(a,a,c,0,Math.PI*2),e.moveTo(a,a),e.strokeStyle=d.border,e.lineWidth=1,e.stroke(),e.beginPath(),e.arc(a,a,Math.round(c*.2),0,Math.PI*2),e.lineWidth=1,e.strokeStyle=d.lines,e.stroke(),e.strokeStyle=d.lines;for(let l=0;l<=7;l++){let u=Math.PI*2/8*l,m=Math.cos(u),D=Math.sin(u),x=m*c*1.1,T=D*c*1.1,$=Math.round(x+a),We=Math.round(T+a),Ne=Math.round(x*.75+a),Ye=Math.round(T*.75+a);e.beginPath(),e.moveTo($,We),e.lineTo(Ne,Ye),e.lineWidth=1,e.stroke();let ue=(l+2)%8*45,pe=r===ue,Xe=pe?d.activePreset:!pe&&i!==null&&i===ue?d.presetHover:d.preset;e.beginPath(),e.arc(Math.round(m*a*o+a),Math.round(D*a*o+a),4,0,Math.PI*2),e.fillStyle=Xe,e.fill()}}var Ie=5,he=14,oe=4,it=-3;function rt(e,n,t,o=.84,i,r){let s=Re(r),a=Math.round(t/2),c=Math.round(o*a*.95);e.translate(a,a),e.rotate((n-180)*Math.PI/180);let d=c;i&&(e.shadowColor=r?"#303030":"#606060",e.shadowBlur=7,e.shadowOffsetX=3,e.shadowOffsetY=3),e.beginPath(),e.moveTo(0,d),e.lineTo(0,0),e.strokeStyle=s.lines,e.lineWidth=2,e.stroke(),e.beginPath(),e.arc(0,0,3,0,Math.PI*2),e.fillStyle=s.toe,e.fill(),e.beginPath(),e.arc(0,0,3,0,Math.PI*2),e.strokeStyle=s.lines,e.lineWidth=1,e.stroke(),e.beginPath(),e.moveTo(0,c+oe),e.lineTo(-Ie,c-he+oe),e.lineTo(0,c-he+oe+it),e.lineTo(Ie,c-he+oe),e.fillStyle=s.tip,e.closePath(),e.fill(),e.strokeStyle=s.lines,e.lineWidth=2,e.lineCap="butt",e.lineJoin="round",e.stroke(),e.shadowColor="transparent",e.setTransform(1,0,0,1,0,0)}function Le(e,n,t=3){let o=Math.round(e),i=Math.abs(n.x),r=Math.abs(n.y);return Math.sqrt(i*i+r*r)-t<=o}function $e(e){return e<0?e+360:e>=360?e-360:e}var st=["canvas"],ie=class e{constructor(n){this.renderer=n;V(()=>{this.dibujar(this.anglesInDegrees(),this.handler(),this.size(),this.darkMode())})}maxMovement=12;radioSizeRatio=.7;presetSizeRatio=.9;canvasMoveSubscription=null;moveSubscription=null;grabHandlerSubscription=null;removeDocumentClickListenerFn=null;removeDocumentTouchEndListenerFn=null;state=C(M);anglesInDegrees=k(()=>this.state.angleDegrees());presetAngles=[];shiftPressed=b(!1);canvasContext=null;handler=b(!1);overPreset=b(null);inside=b(!1);size=F(100);darkMode=F(!1);radius=k(()=>Math.round(this.size()/2));canvas;get canvasElement(){return this.canvas?.nativeElement}onShiftKeyDown(n){this.shiftPressed()||(this.shiftPressed.set(!0),n.preventDefault())}onShiftKeyUp(n){this.shiftPressed()&&(this.shiftPressed.set(!1),n.preventDefault())}ngAfterViewInit(){this.createPresetAngles(),this.subcribeToEvents(),this.dibujar(this.anglesInDegrees())}subcribeToEvents(){this.moveSubscription=_(v(document,"mousemove").pipe(f(t=>t)),v(document,"touchmove",{passive:!1}).pipe(f(t=>t))).pipe(P(()=>this.handler()),E(t=>t.preventDefault()),G(1),f(t=>this.angleDegreesFromPoint(Z(t,this.canvasElement))),f(t=>this.calculateAngleMovement(t)),se()).subscribe(t=>{this.state.onAngleDegreesChange(t)});let n=v(this.canvasElement,"mousemove").pipe(f(t=>t),P(()=>!this.handler()),E(t=>t.preventDefault()),G(1),f(t=>{let o=this.radius(),i=Z(t,this.canvasElement),r=Math.round(o*this.radioSizeRatio);return Le(r,{x:i.x-o,y:i.y-o},3)?{inside:!0,preset:null}:{inside:!1,preset:this.isOverPreset(i)}}));this.canvasMoveSubscription=_(n,v(this.canvasElement,"mouseleave").pipe(E(t=>t.preventDefault()),f(()=>({inside:!1,preset:null})))).pipe(se((t,o)=>t.inside===o.inside&&t.preset===o.preset)).subscribe(t=>{this.inside.set(t.inside),this.overPreset.set(t.preset)}),this.grabHandlerSubscription=_(v(this.canvasElement,"mousedown").pipe(P(()=>this.inside()||this.overPreset()!==null),f(t=>t)),v(this.canvasElement,"touchstart",{passive:!1}).pipe(f(t=>t))).pipe(P(()=>!this.handler()),E(t=>t.preventDefault()),G(1),f(t=>Z(t,this.canvasElement))).subscribe(t=>{this.onGrabHandler(t)})}onDoubleClick(n){this.state.onAngleDegreesChange(0)}onGrabHandler(n){let t=this.isOverPreset(n);if(t!==null){this.state.onAngleDegreesChange(t);return}this.setHandlerSelected()}isOverPreset(n){if(this.inside())return null;for(let t of this.presetAngles)if(L(t.point,n,10))return t.angle!==this.anglesInDegrees()?t.angle:null;return null}stopTracking(){this.handler()!==null&&(this.removeDocumentClickListenerFn?.(),this.removeDocumentTouchEndListenerFn?.(),this.handler.set(!1))}setHandlerSelected(){this.setListeners(),this.handler.set(!0)}angleDegreesFromPoint(n){let t=this.radius(),o=(n.x-t)/t,i=(n.y-t)/t;if(Math.abs(o)<.1&&Math.abs(i)<.1)return this.anglesInDegrees();let r=Math.atan2(o,i),s=Math.round(r*180/Math.PI);return s<0&&(s+=360),s}calculateAngleMovement(n){if(this.shiftPressed())return Math.round(n/45)*45;let t=this.anglesInDegrees(),o=Math.min(this.maxMovement,Math.abs(t-n)),i=t-n>180?o:t-n<-180?-o:t<n?o:-o;return $e(t+i)}setListeners(){this.removeDocumentClickListenerFn=this.renderer.listen("document","mouseup",()=>this.stopTracking()),this.removeDocumentClickListenerFn=this.renderer.listen("document","touchend",()=>this.stopTracking(),{passive:!0})}createPresetAngles(){let n=Math.round(this.size()*this.presetSizeRatio/2),t=Math.round(this.size()/2),o=n*.7071;this.presetAngles.push({angle:0,point:{x:t,y:t+n}}),this.presetAngles.push({angle:45,point:{x:t+o,y:t+o}}),this.presetAngles.push({angle:90,point:{x:t+n,y:t}}),this.presetAngles.push({angle:135,point:{x:t+o,y:t-o}}),this.presetAngles.push({angle:180,point:{x:t,y:t-n}}),this.presetAngles.push({angle:225,point:{x:t-o,y:t-o}}),this.presetAngles.push({angle:270,point:{x:t-n,y:t}}),this.presetAngles.push({angle:315,point:{x:t-o,y:t+o}})}dibujar(n,t=!1,o=this.size(),i=this.darkMode(),r=this.overPreset()){if(!this.canvas)return;this.canvasContext===null&&(this.canvasContext=this.canvasElement.getContext("bitmaprenderer"));let s=this.canvasContext;requestAnimationFrame(()=>{Ae(s,n,o,this.radioSizeRatio,this.presetSizeRatio,r,t,i)})}ngOnDestroy(){this.removeDocumentClickListenerFn?.(),this.removeDocumentTouchEndListenerFn?.(),this.canvasMoveSubscription?.unsubscribe(),this.moveSubscription?.unsubscribe(),this.grabHandlerSubscription?.unsubscribe()}static \u0275fac=function(t){return new(t||e)(Y(N))};static \u0275cmp=S({type:e,selectors:[["zz-orientation-compass"]],viewQuery:function(t,o){if(t&1&&U(st,5),t&2){let i;K(i=Q())&&(o.canvas=i.first)}},hostBindings:function(t,o){t&1&&g("keydown.shift",function(r){return o.onShiftKeyDown(r)},!1,ae)("keyup.shift",function(r){return o.onShiftKeyUp(r)},!1,ae)},inputs:{size:[1,"size"],darkMode:[1,"darkMode"]},decls:3,vars:8,consts:[["canvas",""],["id","canvas",1,"rounded-full",3,"dblclick","width","height"]],template:function(t,o){if(t&1){let i=q();h(0,"div")(1,"canvas",1,0),g("dblclick",function(s){return j(i),W(o.onDoubleClick(s))}),p()()}t&2&&(y(),B("cursor-grabbing",o.handler())("cursor-grab",o.inside())("cursor-pointer",o.overPreset()!==null),w("width",o.size())("height",o.size()))},encapsulation:2,changeDetection:0})};var je=class e{state=C(M);bezierSize=280;compassSize=130;static \u0275fac=function(t){return new(t||e)};static \u0275cmp=S({type:e,selectors:[["zz-test-col"]],decls:12,vars:10,consts:[[1,"bg-application","w-screen","h-screen","overflow-x-hidden"],[1,"sticky","bg-application","z-20","top-0","left-0","right-0","shadow-md","dark:shadow-black/60"],[1,"w-screen","min-h-[calc(100vh_-_50px)]","grid","justify-center","place-content-start","auto-rows-auto","gap-4","px-4","pt-[10svh]","pb-8"],[3,"size","darkMode"],[1,"flex","items-center","gap-4","justify-center"],[1,"-ml-1",3,"size","darkMode"],[1,"flex","flex-col","items-center","gap-4","pr-1"]],template:function(t,o){t&1&&(h(0,"div",0)(1,"div",1),H(2,"zz-gradients-header"),p(),h(3,"main",2)(4,"div"),H(5,"zz-bezier-panel",3),h(6,"div",4),H(7,"zz-orientation-compass",5),h(8,"div",6),H(9,"zz-gradient-colors")(10,"zz-gradient-actions"),p()()()()(),H(11,"zz-notification")),t&2&&(y(3),X("background",o.state.gradient().gradient),B("text-gris-900",!o.state.gradient().darkMode)("text-gris-100",o.state.gradient().darkMode),y(2),w("size",o.bezierSize)("darkMode",o.state.gradient().darkMode),y(2),w("size",o.compassSize)("darkMode",o.state.gradient().darkMode))},dependencies:[Me,J,ye,ee,te,ne,ie],encapsulation:2,changeDetection:0})};export{je as BezierGradientComponent};
